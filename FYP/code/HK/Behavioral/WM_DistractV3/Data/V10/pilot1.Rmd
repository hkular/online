---
title: "Pilot_1"
output: html_document
---
### Load data and libraries, set plot themes, some data wrangling
```{r, echo = FALSE}
library(extraoperators)
library(tidyverse)
library(ggthemes)
library("knitr") 
# use theme_tufte()

setwd('/Users/hollykular/documents/FYP/code/HK/Behavioral/WM_DistractV3/Data/V10')
data1 <-read_csv('WM_pilot_220504.csv')

## hits defined as exactly correct, CW vs. CCW accuracy
# add column describing hit 1 or 0 
H <- data1 %>% mutate(H = case_when(correctresp == resp ~ 1, correctresp != resp ~ 0))
data1$Hit <- H$H
# add column describing false report 1 or 0
FA <- data1 %>%  
  mutate(FA = case_when(correctresp != 5 ~ 0 , correctresp == 5 && correctresp != resp  ~ 1))
data1$FA <- FA$FA

## detection sensitivity
### hit defined as resp = 1-4 when lines were there there and resp = 5 when lines were not there
data1$toorder <- 1:nrow(data1) # so I don't lose order of trials later

data2 <- data1 %>% filter(!is.nan(testorient)) %>% mutate(discrim = case_when(resp == 1 ~ 1, resp == 2 ~ 1, resp == 3 ~1, resp == 4 ~ 1, resp == 5 ~ 0)) # calling discrim hit = 1 for when probe is on target and say something there
data3 <- data1 %>% filter(is.nan(testorient)) %>% mutate(discrim = case_when(resp == 1 ~ 0, resp == 2 ~ 0, resp == 3 ~ 0, resp == 4 ~ 0, resp == 5 ~ 1)) # calling dsicrim hit = 1 for when probe is off target and say nothing there
data <- rbind(data2, data3) # put it back together
data1<- data[order(data$toorder),] # get back in order


### cw vs ccw, hit is raw correctness
clocks <- data1 %>% mutate(clock = case_when(testorient %gl% c(0, 30) ~ 'ccw', testorient %gl% c(300, 360) ~ 'cw', testorient %gl% c(50, 90) ~ 'cw', testorient %gl% c(90, 120) ~ 'ccw'))
data1$clock <- clocks$clock

### horiz vs vert, hit is correctly identifying meridian
meridian <- data1 %>% mutate(meridian = case_when(testorient %gl% c(50,120) ~ 'h',   testorient %gl% c(0,30) ~ 'v', testorient %gl% c(300,360) ~ 'v')) # this is backwards to what is intuitive, but PTB displays the orients opposite of expectation
data1$meridian <- meridian$meridian
### calculate meridian hits
data2 <- data1 %>% filter(meridian == 'v') %>% mutate(ori = case_when(resp == 1 ~ 1, resp == 2 ~ 0, resp == 3 ~ 0, resp == 4 ~ 1, resp == 5 ~ 0)) # calling  hit = 1 for vert
data3 <- data1 %>%  filter(meridian == 'h') %>% mutate(ori = case_when(resp == 1 ~ 0, resp == 2 ~ 1, resp == 3 ~ 1, resp == 4 ~ 0, resp == 5 ~ 0)) # calling hit = 1 for horiz
data4 <- data1 %>% filter(is.na(meridian)) %>% mutate(ori = NA) # calling hit = NA for off target probe
data <- rbind(data2, data3, data4) # put it back together
data1<- data[order(data$toorder),] # get back in order


rm(FA, H, data2, data3,data, data4,clocks, meridian) # clean up vars not going to use

s = data1$subject[nrow(data1)] # total number of subjects to use for later
```

## Individual subject quality check
### Response bias in task response
```{r}
# check for non-response numbers exclude subjects with greater than 5% (trials NA response>10)
nonrespcheck <- data1 %>% group_by(subject) %>% count(resp)
nonrespcheck <- nonrespcheck%>% filter(is.nan(resp))
for(i in 1:nrow(nonrespcheck)){if (nonrespcheck$n[i] >10) {print(paste0('exclude subject ', nonrespcheck$subject[i], ' no response'))}} # prints out warning to exlude subject who didn't respond to more than 5% of trials
rm(nonrespcheck, i) # clear vars no longer using

# check for response bias
## check task response distribution
respbias<- data1%>% group_by(subject) %>% count(resp)
respbias <- respbias %>% filter(!is.nan(resp))
respbias<- respbias[order(respbias$subject),] # reorganizes
totals <-  rowsum(respbias$n, rep(1:s, each = 5))
trials <- rep(totals, each = 5)
respbias$p <-  respbias$n/trials
respbias1 <- respbias %>% filter(!resp == 5)
respbias2 <- respbias %>% filter(resp == 5)
for(i in 1:nrow(respbias1)){if (respbias1$p[i] >.25) {print(paste0('check subject', respbias1$subject[i], ' response bias'))}} # warning
for(i in 1:nrow(respbias2)){if (respbias2$p[i] >.65) {print(paste0('check subject', respbias2$subject[i], ' response bias'))}} # warning
# check for >25% of response for 1 through 4, and >65% for response 5

# graph to see distribution of responses
respbiasplot <- respbias %>% 
  ggplot(aes(x = subject, y = p, fill = factor(resp)))+
  geom_col(position = position_dodge())+
  labs(x = 'Subject', y = 'Proportion', title = "Distribution of responses",fill = 'Response type')+
  scale_x_continuous(breaks = seq(1,s,1))+
  scale_fill_brewer(palette = 'Set1', labels = c('CCW V', 'CCW H', 'CW H', 'CW V', 'nothing', 'non-resp'))+  
  theme(plot.title = element_text(hjust = 0.5))
# respbiasplot
rm(trials, totals, respbias, respbias1, respbias2, i) # clears vars no longer using
```
### Response bias in confidence reports
```{r}
# check for non-response numbers and exclude subjects with greater than 10% (trials NA response >19)
nonconfcheck <- data1 %>% group_by(subject) %>% count(conf)
nonconfcheck <- nonconfcheck%>% filter(is.nan(conf))
for(i in 1:nrow(nonconfcheck)){if (nonconfcheck$n[i] >19) {print(paste0('flag subject ', nonconfcheck$subject[i], ' confidence no response'))}} # prints out warning to exlude subject who didn't respond to more than 5% of trials
rm(nonconfcheck, i) # clear vars no longer using
## check confidence response distribution
confbias<- data1%>% group_by(subject) %>% count(conf)
confbias <- confbias %>% filter(!is.nan(conf))
confbias<- confbias[order(confbias$subject),] # reorganizes
totals <-  rowsum(confbias$n, rep(1:s, each = 3))
trials <- rep(totals, each = 3)
confbias$p <-  confbias$n/trials
for(i in 1:nrow(confbias)){if (confbias$p[i] >.85) {print(paste0('check subject', confbias$subject[i], ' confidence bias'))}} # warning
# check to see if they did same confidence response for >85% of trials

# graph to see distribution of confidences
confbiasplot <- confbias %>% 
  ggplot(aes(x = subject, y = p, fill = factor(conf)))+
  geom_col(position = position_dodge())+
  labs(x = 'Subject', y = 'Proportion', title = "Distribution of responses",fill = 'Confidence level')+
  scale_x_continuous(breaks = seq(1,s,1))+
  scale_fill_brewer(palette = 'Set1')+  
  theme(plot.title = element_text(hjust = 0.5))
# confbiasplot
rm(trials, totals, confbias, i) # clears vars no longer using
```
 
## Performance 
### Performance descriminating object there or not 
#### i.e. response 1-4 (lines there) vs. response 5 (noise there)
#### get hits
```{r}
# count hits
hit1<- data1 %>% filter(!is.nan(testorient)) %>% group_by(subject, discrim) %>% summarise(n=n()) # when probe on target count hits
hit1<- hit1%>% filter(!is.na(discrim)) # remove non response

# check for missing 0s
if (nrow(hit1) < 2*s) {print(paste0('warning check subject missing row'))}# warning missing data


```
##### fill in missing data - so far manual
```{r}
# fill in missing data
## subject 1 had  times when reported nothing there when something there
missing <- data.frame(1, 0, 0)
names(missing) <- c('subject', 'discrim', 'n')
hit1<- rbind(hit1, missing) # add back missing data
hit1 <- hit1[order(hit1$subject, hit1$discrim),] # reorder
rm(missing)

# calculate rate
totals <- rowsum(hit1$n, rep(1:s, each = 2)) 
trials <- rep(totals, each = 2)
hit1$rate <- hit1$n/trials
rm(trials, totals)


hit1sd<-sd(hit1$rate)
```
#### get FAs
```{r}
# count false alarms
FA1 <- data1 %>% filter(is.nan(testorient)) %>% group_by(subject, discrim, .drop = FALSE) %>% summarise(n=n()) # when probe on target count hits
FA1 <- FA1 %>% filter(!is.na(discrim)) # remove non response

# check for missing 0s
if (nrow(FA1) < 2*s) {print(paste0('warning check subject missing row'))}# warning missing data


```
##### fill in missing data - so far manual
```{r}
# ## subject 5 had no FAs
missing <- data.frame(5, 0, 0)
names(missing) <- c('subject', 'discrim', 'n')
FA1<- rbind(FA1, missing) # add back missing data
FA1 <- FA1[order(FA1$subject),] # reorder
## subject 8 had no FAs
missing <- data.frame(8, 0, 0)
names(missing) <- c('subject', 'discrim', 'n')
FA1<- rbind(FA1, missing) # add back missing data
FA1 <- FA1[order(FA1$subject, FA1$discrim),] # reorder
rm(missing)

# calculate rate
totals <- rowsum(FA1$n, rep(1:s, each = 2))
trials <- rep(totals, each = 2)
FA1$rate <- FA1$n/trials
rm( trials, totals)

FA1sd<-sd(FA1$rate)
```
#### calculate d'
```{r}
hits <- hit1 %>% filter(discrim == 1) # hits
misses <- hit1 %>% filter(discrim == 0) # misses
FAs<- FA1 %>% filter(discrim == 0) # false alarms
CRs<- FA1 %>% filter(discrim == 1) # correct rejections
d1 <- cbind(hits$subject, hits$n, misses$n, FAs$n, CRs$n)
d1<-data.frame(d1)
names(d1) <- c('subject', 'hits','misses', 'false_alarms', 'correct_rejections')
d1$Hrate<- hits$rate
d1$FArate<- FAs$rate

d1$dprime<- qnorm(d1$Hrate) - qnorm(d1$FArate)

rm(hits, misses, FAs, CRs)# cleanup vars
```
#### plot performance (hits)
```{r}

hitplot1 <- hit1 %>% filter(discrim == 1) %>%
  ggplot(aes(x = subject, y = rate*100))+
  geom_col()+
  labs(x = 'Subject', y = 'Correct (%)',  title = "Discrimination Accuracy")+
  scale_x_continuous(breaks = seq(1,s,1))+
  theme_classic()+
  theme(plot.title = element_text(hjust = 0.5), legend.position = 'none')
hitplot1
hitavg<- hit1 %>% filter(discrim ==1)
hitavg1 <- mean(hitavg$rate)
rm(hitavg)
```
#### plot performance (FAs)
```{r}

FAplot1 <- FA1 %>% filter(discrim == 0) %>%
  ggplot(aes(x = subject, y = rate))+
  geom_col()+
  labs(x = 'Subject', y = 'False Alarm rate',  title = "False Alarms")+
  scale_x_continuous(breaks = seq(1,s,1))+
  theme_classic()+
  theme(plot.title = element_text(hjust = 0.5), legend.position = 'none')
FAplot1
FAavg<- FA1 %>% filter(discrim ==0)
FAavg1 <- mean(FAavg$rate)
rm(FAavg)
```
#### plot detection sensitivity (d')
```{r}
dplot1 <- d1 %>%
  #filter(subject == c(1, 2, 3, 4, 5, 6, 7, 8))%>% # can exclude subjects with 0 FA
  ggplot(aes(x = subject, y = dprime)) +
  geom_col()+
  labs(x = 'Subject', y = "d'",  title = "Detection sensitivity")+
  scale_x_continuous(breaks = seq(1,s,1))+
  annotate(geom='text', x = c(1,5,8), y=2.5, label= 'inf', color = 'white')+
  theme_classic()+
  theme(plot.title = element_text(hjust = 0.5), legend.position = 'none')
dplot1

# figure out a way to label infinity
# avg excluding inf
davg<- d1 %>% filter(!is.infinite(dprime))
davg1 <- mean(davg$dprime)
da1sd<-sd(davg$dprime)
rm(davg)

#clear plots and vars not using

```
#
### Raw performance
#### i.e. response must be exact to get correct
#### get hits
```{r}
# count hits
hit2<- data1 %>% filter(!is.nan(testorient)) %>% group_by(subject,Hit,.drop = FALSE) %>% summarise(n=n()) # when probe on target count hits
hit2<- hit2%>% filter(!is.na(Hit)) # remove non response

# check for missing 0s
if (nrow(hit2) < 2*s) {print(paste0('warning check subject missing row'))}# warning missing data
```
##### fill in missing data - so far manual
```{r}
# fill in missing data
##no subject had no misses
# missing <- data.frame(1, 0, 0)
# names(missing) <- c('subject', 'hit', 'n')
# hit<- rbind(hit, missing) # add back missing data
# hit <- hit[order(hit$subject, hit$Hit),] # reorder
# rm(missing)

# calculate rate
totals <- rowsum(hit2$n, rep(1:s, each = 2)) 
trials <- rep(totals, each = 2)
hit2$rate <- hit2$n/trials
rm(trials, totals)

hit2sd<-sd(hit2$rate)
```
#### get FAs
```{r}
# count false alarms
FA2 <- data1 %>% filter(is.nan(testorient)) %>% group_by(subject, .drop = FALSE) %>% count(Hit) # when probe on target count hits
FA2 <- FA2 %>% filter(!is.na(Hit)) # remove non response

# check for missing 0s
if (nrow(FA2) < 2*s) {print(paste0('warning check subject missing row'))}# warning missing data


```
##### fill in missing data - so far manual
```{r}
## subject 5 had no FAs
missing <- data.frame(5, 0, 0)
names(missing) <- c('subject', 'Hit', 'n')
FA2<- rbind(FA2, missing) # add back missing data
FA2 <- FA2[order(FA2$subject),] # reorder
## subject 8 had no FAs
missing <- data.frame(8, 0, 0)
names(missing) <- c('subject', 'Hit', 'n')
FA2<- rbind(FA2, missing) # add back missing data
FA2 <- FA2[order(FA2$subject, FA2$Hit),] # reorder
rm(missing)

# calculate rate
totals <- rowsum(FA2$n, rep(1:s, each = 2)) 
trials <- rep(totals, each = 2)
FA2$rate <- FA2$n/trials
rm( trials, totals)

FA2sd<-sd(FA2$rate)
```
#### calculate d'
```{r}
hits <- hit2 %>% filter(Hit == 1) # hits
misses <- hit2 %>% filter(Hit == 0) # misses
FAs<- FA2 %>% filter(Hit == 0) # false alarms
CRs<- FA2 %>% filter(Hit == 1) # correct rejections
d2 <- cbind(hits$subject, hits$n, misses$n, FAs$n, CRs$n)
d2<-data.frame(d2)
names(d2) <- c('subject', 'hits','misses', 'false_alarms', 'correct_rejections')
d2$Hrate<- hits$rate
d2$FArate<- FAs$rate

d2$dprime<- qnorm(d2$Hrate) - qnorm(d2$FArate)

rm(hits, misses, FAs, CRs)# cleanup vars
```
#### plot performance (hits)
```{r}

hitplot2 <- hit2 %>% filter(Hit == 1) %>%
  ggplot(aes(x = subject, y = rate*100))+
  geom_col()+
  labs(x = 'Subject', y = 'Correct(%)',  title = "Orientation Accuracy")+
  scale_x_continuous(breaks = seq(1,s,1))+
  ylim(0,100)+
  theme_classic()+
  theme(plot.title = element_text(hjust = 0.5), legend.position = 'none')
hitplot2

hitavg<- hit2 %>% filter(Hit ==1)
hitavg2 <- mean(hitavg$rate)
rm(hitavg)
```
#### plot performance (FAs)
```{r}

FAplot2 <- FA2 %>% filter(Hit == 0) %>%
  ggplot(aes(x = subject, y = rate))+
  geom_col()+
  labs(x = 'Subject', y = 'False Alarm rate',  title = "False Alarms")+
  scale_x_continuous(breaks = seq(1,s,1))+
  ylim(0, 0.3)+
  theme_classic()+
  theme(plot.title = element_text(hjust = 0.5), legend.position = 'none')
FAplot2

FAavg<- FA2 %>% filter(Hit ==0)
FAavg2 <- mean(FAavg$rate)
rm(FAavg)
```
#### plot detection sensitivity (d')
```{r}
dplot2 <- d2 %>%
  #filter(subject == c(1, 2, 3, 4, 5, 6, 7, 8))%>% # can exclude subjects with 0 FA
  ggplot(aes(x = subject, y = dprime)) +
  geom_col()+
  labs(x = 'Subject', y = "d'",  title = "Detection sensitivity")+
  scale_x_continuous(breaks = seq(1,s,1))+
  theme_classic()+
  theme(plot.title = element_text(hjust = 0.5), legend.position = 'none')
dplot2

# figure out a way to label infinity
davg<- d2 %>% filter(!is.infinite(dprime))
davg2 <- mean(davg$dprime)
da2sd<-sd(davg$dprime)
rm(davg)

```






#
#
## Effect of Contrast
### Performance descriminating object there or not 
#### i.e. response 1-4 (lines there) vs. response 5 (noise there)
#### get hits
```{r}
# count hits
hit3<- data1 %>% filter(!is.nan(testorient)) %>% group_by(subject, contrast, .drop = FALSE) %>% count(discrim) # when probe on target count hits
hit3<- hit3%>% filter(!is.na(discrim)) # remove non response

# check for missing 0s
if (nrow(hit3) < 4*s) {print(paste0('warning check subject missing row'))}# warning missing data

```
##### fill in missing data - so far manual
```{r}
# fill in missing data
## subject 1, 2, 8 had  times when reported nothing there when something there
missing <- data.frame(1, 0.5, 0, 0)
names(missing) <- c('subject', 'contrast','discrim', 'n')
hit3<- rbind(hit3, missing) # add back missing data
missing <- data.frame(1, 0.8, 0, 0)
names(missing) <- c('subject', 'contrast','discrim', 'n')
hit3<- rbind(hit3, missing) # add back missing data
missing <- data.frame(2, 0.5, 0, 0)
names(missing) <- c('subject', 'contrast','discrim', 'n')
hit3<- rbind(hit3, missing) # add back missing data
missing <- data.frame(8, 0.8, 0, 0)
names(missing) <- c('subject', 'contrast','discrim', 'n')
hit3<- rbind(hit3, missing) # add back missing data
hit3 <- hit3[order(hit3$subject, hit3$contrast),] # reorder
rm(missing)

# calculate rate
totals <- rowsum(hit3$n, rep(1:(2*s), each = 2)) 
trials <- rep(totals, each = 2)
hit3$rate <- hit3$n/trials
rm(trials, totals)


```
#### get FAs
```{r}
# count false alarms
FA3 <- data1 %>% filter(is.nan(testorient)) %>% group_by(subject, contrast, .drop = FALSE) %>% count(discrim) # when probe on target count hits
FA3 <- FA3 %>% filter(!is.na(discrim)) # remove non response

# check for missing 0s
if (nrow(FA3) < 4*s) {print(paste0('warning check subject missing row'))}# warning missing data


```
##### fill in missing data - so far manual
```{r}
## subject 5, 8 had no FAs
missing <- data.frame(2, 0.5, 0, 0)
names(missing) <- c('subject', 'contrast','discrim', 'n')
FA3<- rbind(FA3, missing) # add back missing data
missing <- data.frame(5, 0.5, 0, 0)
names(missing) <- c('subject', 'contrast','discrim', 'n')
FA3<- rbind(FA3, missing) # add back missing data
missing <- data.frame(5, 0.8, 0, 0)
names(missing) <- c('subject', 'contrast','discrim', 'n')
FA3<- rbind(FA3, missing) # add back missing data
missing <- data.frame(6, 0.8, 0, 0)
names(missing) <- c('subject', 'contrast','discrim', 'n')
FA3<- rbind(FA3, missing) # add back missing data
missing <- data.frame(8, 0.5, 0, 0)
names(missing) <- c('subject', 'contrast','discrim', 'n')
FA3<- rbind(FA3, missing) # add back missing data
missing <- data.frame(8, 0.8, 0, 0)
names(missing) <- c('subject', 'contrast','discrim', 'n')
FA3<- rbind(FA3, missing) # add back missing data
FA3 <- FA3[order(FA3$subject, FA3$contrast),] # reorder
rm(missing)

# calculate rate
totals <- rowsum(FA3$n, rep(1:(2*s), each = 2)) 
trials <- rep(totals, each = 2)
FA3$rate <- FA3$n/trials
rm( trials, totals)
```
#### calculate d'
```{r}
hits <- hit3 %>% filter(discrim == 1) # hits
misses <- hit3 %>% filter(discrim == 0) # misses
FAs<- FA3 %>% filter(discrim == 0) # false alarms
CRs<- FA3 %>% filter(discrim == 1) # correct rejections
d3 <- cbind(hits$subject,hits$contrast, hits$n, misses$n, FAs$n, CRs$n)
d3<-data.frame(d3)
names(d3) <- c('subject','contrast', 'hits','misses', 'false_alarms', 'correct_rejections')
d3$Hrate<- hits$rate
d3$FArate<- FAs$rate

d3$dprime<- qnorm(d3$Hrate) - qnorm(d3$FArate)

rm(hits, misses, FAs, CRs)# cleanup vars
```
#### plot performance (hits)
```{r}

hitplot3 <- hit3 %>% filter(discrim == 1) %>%
  ggplot(aes(x = subject, y = rate, fill = factor(contrast)))+
  geom_col(position = position_dodge())+
  labs(x = 'Subject', y = 'Hit rate',  title = "Performance", fill = 'contrast')+
  scale_x_continuous(breaks = seq(1,s,1))+
  theme_classic()+
  theme(plot.title = element_text(hjust = 0.5))
hitplot3

hitavgh<- hit3 %>% filter(discrim ==1, contrast == 0.8)
hitavgh3 <- mean(hitavgh$rate)
hith3sd<-sd(hitavgh$rate)
hitavgl<- hit3 %>% filter(discrim ==1, contrast == 0.5)
hitavgl3 <- mean(hitavgl$rate)
hitl3sd<-sd(hitavgl$rate)
rm(hitavgh, hitavgl)
```
#### plot performance (FAs)
```{r}

FAplot3 <- FA3 %>% filter(discrim == 0) %>%
  ggplot(aes(x = subject, y = rate, fill = factor(contrast)))+
  geom_col(position = position_dodge())+
  labs(x = 'Subject', y = 'False Alarm rate',  title = "Performance", fill = 'contrast')+
  scale_x_continuous(breaks = seq(1,s,1))+
  theme_classic()+
  theme(plot.title = element_text(hjust = 0.5))
FAplot3

FAavgh<- FA3 %>% filter(discrim ==0, contrast == 0.8)
FAavgh3 <- mean(FAavgh$rate)
FAh3sd<-sd(FAavgh$rate)
FAavgl<- FA3 %>% filter(discrim ==0, contrast == 0.5)
FAavgl3 <- mean(FAavgl$rate)
FAl3sd<-sd(FAavgl$rate)
rm(FAavgh, FAavgl)
```
#### plot detection sensitivity (d')
```{r}
dplot3 <- d3 %>%
  #filter(subject == c(1, 2, 3, 4, 5, 6, 7, 8))%>% # can exclude subjects with 0 FA
  ggplot(aes(x = subject, y = dprime, fill = factor(contrast)))+
  geom_col(position = position_dodge())+
  labs(x = 'Subject', y = "d'",  title = "Detection sensitivity", fill = 'contrast')+
  scale_x_continuous(breaks = seq(1,s,1))+
  theme_classic()+
  theme(plot.title = element_text(hjust = 0.5))
dplot3

# figure out a way to label infinity
davgl<- d3 %>% filter(!is.infinite(dprime), contrast == 0.5)
davgl3 <- mean(davgl$dprime)
dal3sd<-sd(davgl$dprime)
davgh<- d3 %>% filter(!is.infinite(dprime), contrast == 0.8)
davgh3 <- mean(davgh$dprime)
dah3sd<-sd(davgh$dprime)
rm(davgl ,davgh)

```
# Effect of Contrast comparison
### t-test
```{r}
#paired 1 sample t test because we're comparing subjects to themselves
# calculated difference in performance on orientation discrimination bewteen noise distractor contrast conditions
lowc <- hit3 %>% filter(contrast == 0.5, discrim == 1)
highc<- hit3 %>% filter(contrast == 0.8, discrim == 1)
diffc<- lowc$rate - highc$rate
ttest1 <- t.test(diffc, mu = 0)
ttest1
``` 

#
##Effect of Contrast
### Raw performance (exact response cw vs ccw)
#### Performance with CCW vs CW discrim, does contrast help?
#### i.e. response must be exact to get correct
#### get hits
```{r}
# count hits
hit4<- data1 %>% filter(!is.nan(testorient)) %>% group_by(subject,contrast, Hit, .drop = FALSE) %>% summarize(n=n())# when probe on target count hits

hit4<- hit4%>% filter(!is.na(Hit)) # remove non response

# check for missing 0s
if (nrow(hit4) < 4*s) {print(paste0('warning check subject missing row'))}# warning missing data
```
##### fill in missing data - so far manual
```{r}
# fill in missing data
##no subject had no misses
# missing <- data.frame(1, 0, 0)
# names(missing) <- c('subject', 'hit', 'n')
# hit<- rbind(hit, missing) # add back missing data
# hit <- hit[order(hit$subject, hit$Hit),] # reorder
# rm(missing)

# calculate rate
totals <- rowsum(hit4$n, rep(1:(2*s), each = 2)) 
trials <- rep(totals, each = 2)
hit4$rate <- hit4$n/trials
rm(trials, totals)

```
#### get FAs
```{r}
# count false alarms
FA4 <- data1 %>% filter(is.nan(testorient)) %>% group_by(subject, contrast, .drop = FALSE) %>% count(Hit) # when probe on target count hits
FA4 <- FA4 %>% filter(!is.na(Hit)) # remove non response

# check for missing 0s
if (nrow(FA4) < 4*s) {print(paste0('warning check subject missing row'))}# warning missing data

```
##### fill in missing data - so far manual
```{r}
## subject 2, 5, 6, 8 had no FAs in some conditions
missing <- data.frame(2,0.5, 0, 0)
names(missing) <- c('subject', 'contrast','Hit', 'n')
FA4<- rbind(FA4, missing) # add back missing data
missing <- data.frame(5,0.5, 0, 0)
names(missing) <- c('subject', 'contrast','Hit', 'n')
FA4<- rbind(FA4, missing) # add back missing data
missing <- data.frame(5,0.8, 0, 0)
names(missing) <- c('subject', 'contrast','Hit', 'n')
FA4<- rbind(FA4, missing) # add back missing data
missing <- data.frame(6,0.8, 0, 0)
names(missing) <- c('subject', 'contrast','Hit', 'n')
FA4<- rbind(FA4, missing) # add back missing data
missing <- data.frame(8,0.5, 0, 0)
names(missing) <- c('subject', 'contrast','Hit', 'n')
FA4<- rbind(FA4, missing) # add back missing data
missing <- data.frame(8,0.8, 0, 0)
names(missing) <- c('subject', 'contrast','Hit', 'n')
FA4<- rbind(FA4, missing) # add back missing data
rm(missing)
FA4 <- FA4[order(FA4$subject, FA4$contrast),] # reorder

# calculate rate
totals <- rowsum(FA4$n, rep(1:(2*s), each = 2)) 
trials <- rep(totals, each = 2)
FA4$rate <- FA4$n/trials
rm( trials, totals)
```
#### calculate d'
```{r}
hits <- hit4 %>% filter(Hit == 1) # hits
misses <- hit4 %>% filter(Hit == 0) # misses
FAs<- FA4 %>% filter(Hit == 0) # false alarms
CRs<- FA4 %>% filter(Hit == 1) # correct rejections
d4 <- cbind(hits$subject, hits$contrast, hits$n, misses$n, FAs$n, CRs$n)
d4<-data.frame(d4)
names(d4) <- c('subject', 'contrast','hits','misses', 'false_alarms', 'correct_rejections')
d4$Hrate<- hits$rate
d4$FArate<- FAs$rate

d4$dprime<- qnorm(d4$Hrate) - qnorm(d4$FArate)

rm(hits, misses, FAs, CRs)# cleanup vars
```
#### plot performance (hits)
```{r}

hitplot4 <- hit4 %>% filter(Hit == 1) %>%
  ggplot(aes(x = subject, y = rate, fill = factor(contrast)))+
  geom_col(position = position_dodge())+
  labs(x = 'Subject', y = 'Hit rate',  title = "Performance", fill = 'contrast')+
  scale_x_continuous(breaks = seq(1,s,1))+
  theme_classic()+
  theme(plot.title = element_text(hjust = 0.5))
hitplot4

hitavgh<- hit4 %>% filter(Hit ==1, contrast == 0.8)
hitavgh4 <- mean(hitavgh$rate)
hith4sd<-sd(hitavgh$rate)
hitavgl<- hit4 %>% filter(Hit ==1, contrast == 0.5)
hitavgl4 <- mean(hitavgl$rate)
hitl4sd<-sd(hitavgl$rate)
rm(hitavgh, hitavgl)
```
#### plot performance (FAs)
```{r}

FAplot4 <- FA4 %>% filter(Hit == 0) %>%
  ggplot(aes(x = subject, y = rate, fill = factor(contrast)))+
  geom_col(position = position_dodge())+
  labs(x = 'Subject', y = 'False Alarm rate',  title = "Performance", fill = 'contrast')+
  scale_x_continuous(breaks = seq(1,s,1))+
  theme_classic()+
  theme(plot.title = element_text(hjust = 0.5))
FAplot4
```
#### plot detection sensitivity (d')
```{r}
dplot4 <- d4 %>%
  #filter(subject == c(1, 2, 3, 4, 5, 6, 7, 8))%>% # can exclude subjects with 0 FA
  ggplot(aes(x = subject, y = dprime, fill = factor(contrast)))+
  geom_col(position = position_dodge())+
  labs(x = 'Subject', y = "d'",  title = "Detection sensitivity", fill = 'contrast')+
  scale_x_continuous(breaks = seq(1,s,1))+
  theme_classic()+
  theme(plot.title = element_text(hjust = 0.5))
dplot4

davgh<- d4 %>% filter(!is.infinite(dprime),contrast == 0.8)
davgh4 <- mean(davgh$dprime)
dah4sd<-sd(davgh$dprime)
davgl<- d4 %>% filter(!is.infinite(dprime),contrast == 0.5)
davgl4 <- mean(davgl$dprime)
dal4sd<-sd(davgl$dprime)
rm(davgh, davgl)

# figure out a way to label infinity

# clear vars
```
# Effect of Contrast comparison
### t-test
```{r}
#paired 1 sample t test because we're comparing subjects to themselves
# calculated difference in performance on orientation discrimination bewteen noise distractor contrast conditions
lowc <- hit4 %>% filter(contrast == 0.5, Hit == 1)
highc<- hit4 %>% filter(contrast == 0.8, Hit == 1)
diffc<- lowc$rate - highc$rate
ttest2 <- t.test(diffc, mu = 0)
ttest2
```



### Performance discriminating vert vs horiz
#### get hits
```{r}
# count hits
hit<- data1 %>% filter(!is.nan(testorient)) %>% group_by(subject,contrast,ori,.drop = FALSE) %>% summarise(n=n()) # when probe on target count hits
hit<- hit%>% filter(!is.na(ori)) # remove non response

# check for missing 0s
if (nrow(hit) < 2*s) {print(paste0('warning check subject missing row'))}# warning missing data
```
##### fill in missing data - so far manual
```{r}
# fill in missing data
##no subject had no misses
# missing <- data.frame(1, 0, 0)
# names(missing) <- c('subject', 'hit', 'n')
# hit<- rbind(hit, missing) # add back missing data
# hit <- hit[order(hit$subject, hit$Hit),] # reorder
# rm(missing)

# calculate rate
totals <- rowsum(hit$n, rep(1:(2*s), each = 2)) 
trials <- rep(totals, each = 2)
hit$rate <- hit$n/trials
rm(trials, totals)
```
#### plot performance (hits)
```{r}

hitplot5 <- hit %>% filter(ori == 1) %>%
  ggplot(aes(x = subject, y = rate, fill = factor(contrast)))+
  geom_col(position = 'dodge')+
  labs(x = 'Subject', y = 'Hit rate',  title = "Performance" , fill = 'contrast')+
  scale_x_continuous(breaks = seq(1,s,1))+
  theme_classic()+
  theme(plot.title = element_text(hjust = 0.5))
hitplot5


```




#
#
## Effect of set size
### Performance descriminating object there or not 
#### i.e. response 1-4 (lines there) vs. response 5 (noise there)
#### get hits
```{r}
# count hits
hit5<- data1 %>% filter(!is.nan(testorient)) %>% group_by(subject, setsize, .drop = FALSE) %>% count(discrim) # when probe on target count hits
hit5<- hit5%>% filter(!is.na(discrim)) # remove non response

# check for missing 0s
if (nrow(hit5) < 4*s) {print(paste0('warning check subject missing row'))}# warning missing data

```
##### fill in missing data - so far manual
```{r}
# fill in missing data
## subject 1, 2, 8 had  times when reported nothing there when something there
missing <- data.frame(1, 1, 0, 0)
names(missing) <- c('subject', 'setsize','discrim', 'n')
hit5<- rbind(hit5, missing) # add back missing data
missing <- data.frame(1, 2, 0, 0)
names(missing) <- c('subject', 'setsize','discrim', 'n')
hit5<- rbind(hit5, missing) # add back missing data
missing <- data.frame(2, 1, 0, 0)
names(missing) <- c('subject', 'setsize','discrim', 'n')
hit5<- rbind(hit5, missing) # add back missing data
missing <- data.frame(5, 1, 0, 0)
names(missing) <- c('subject', 'setsize','discrim', 'n')
hit5<- rbind(hit5, missing) # add back missing data
missing <- data.frame(6, 1, 0, 0)
names(missing) <- c('subject', 'setsize','discrim', 'n')
hit5<- rbind(hit5, missing) # add back missing data
missing <- data.frame(7, 2, 0, 0)
names(missing) <- c('subject', 'setsize','discrim', 'n')
hit5<- rbind(hit5, missing) # add back missing data
missing <- data.frame(8, 1, 0, 0)
names(missing) <- c('subject', 'setsize','discrim', 'n')
hit5<- rbind(hit5, missing) # add back missing data
hit5 <- hit5[order(hit5$subject, hit5$setsize),] # reorder
rm(missing)

# calculate rate
totals <- rowsum(hit5$n, rep(1:(2*s), each = 2)) 
trials <- rep(totals, each = 2)
hit5$rate <- hit5$n/trials
rm(trials, totals)


```
#### get FAs
```{r}
# count false alarms
FA5 <- data1 %>% filter(is.nan(testorient)) %>% group_by(subject, setsize, .drop = FALSE) %>% count(discrim) # when probe on target count hits
FA5 <- FA5 %>% filter(!is.na(discrim)) # remove non response

# check for missing 0s
if (nrow(FA5) < 4*s) {print(paste0('warning check subject missing row'))}# warning missing data


```
##### fill in missing data - so far manual
```{r}
## subject 5, 8 had no FAs
missing <- data.frame(2, 2, 0, 0)
names(missing) <- c('subject', 'setsize','discrim', 'n')
FA5<- rbind(FA5, missing) # add back missing data
missing <- data.frame(5, 1, 0, 0)
names(missing) <- c('subject', 'setsize','discrim', 'n')
FA5<- rbind(FA5, missing) # add back missing data
missing <- data.frame(5, 2, 0, 0)
names(missing) <- c('subject', 'setsize','discrim', 'n')
FA5<- rbind(FA5, missing) # add back missing data
missing <- data.frame(6, 1, 0, 0)
names(missing) <- c('subject', 'setsize','discrim', 'n')
FA5<- rbind(FA5, missing) # add back missing data
missing <- data.frame(8, 1, 0, 0)
names(missing) <- c('subject', 'setsize','discrim', 'n')
FA5<- rbind(FA5, missing) # add back missing data
missing <- data.frame(8, 2, 0, 0)
names(missing) <- c('subject', 'setsize','discrim', 'n')
FA5<- rbind(FA5, missing) # add back missing data
FA5 <- FA5[order(FA5$subject, FA5$setsize),] # reorder
rm(missing)

# calculate rate
totals <- rowsum(FA5$n, rep(1:(2*s), each = 2)) 
trials <- rep(totals, each = 2)
FA5$rate <- FA5$n/trials
rm( trials, totals)
```
#### calculate d'
```{r}
hits <- hit5 %>% filter(discrim == 1) # hits
misses <- hit5 %>% filter(discrim == 0) # misses
FAs<- FA5 %>% filter(discrim == 0) # false alarms
CRs<- FA5 %>% filter(discrim == 1) # correct rejections
d5 <- cbind(hits$subject,hits$setsize, hits$n, misses$n, FAs$n, CRs$n)
d5<-data.frame(d5)
names(d5) <- c('subject','setsize', 'hits','misses', 'false_alarms', 'correct_rejections')
d5$Hrate<- hits$rate
d5$FArate<- FAs$rate

d5$dprime<- qnorm(d5$Hrate) - qnorm(d5$FArate)

rm(hits, misses, FAs, CRs)# cleanup vars
```
#### plot performance (hits)
```{r}

hitplot5 <- hit5 %>% filter(discrim == 1) %>%
  ggplot(aes(x = subject, y = rate, fill = factor(setsize)))+
  geom_col(position = position_dodge())+
  labs(x = 'Subject', y = 'Hit rate',  title = "Performance", fill = 'setsize')+
  scale_x_continuous(breaks = seq(1,s,1))+
  theme_classic()+
  theme(plot.title = element_text(hjust = 0.5))
hitplot5

hitavgss1<- hit5 %>% filter(discrim ==1, setsize == 1)
hitavgss15 <- mean(hitavgss1$rate)
hit5ss1sd<-sd(hitavgss1$rate)
hitavgss2<- hit5 %>% filter(discrim ==1, setsize == 2)
hitavgss25 <- mean(hitavgss2$rate)
hitss2sd<-sd(hitavgss2$rate)
rm(hitavgss1, hitavgss2)
```
#### plot performance (FAs)
```{r}

FAplot5 <- FA5 %>% filter(discrim == 0) %>%
  ggplot(aes(x = subject, y = rate, fill = factor(setsize)))+
  geom_col(position = position_dodge())+
  labs(x = 'Subject', y = 'False Alarm rate',  title = "Performance", fill = 'setsize')+
  scale_x_continuous(breaks = seq(1,s,1))+
  theme_classic()+
  theme(plot.title = element_text(hjust = 0.5))
FAplot5

FAavgss1<- FA5 %>% filter(discrim ==0, setsize == 1)
FAavgss15 <- mean(FAavgss1$rate)
FA5ss1sd<-sd(FAavgss1$rate)
FAavgss2<- FA5 %>% filter(discrim ==0, setsize == 2)
FAavgss25 <- mean(FAavgss2$rate)
FA5ss2sd<-sd(FAavgss2$rate)
rm(FAavgss1, FAavgss2)
```
#### plot detection sensitivity (d')
```{r}
dplot5 <- d5%>%
  #filter(subject == c(1, 2, 3, 4, 5, 6, 7, 8))%>% # can exclude subjects with 0 FA
  ggplot(aes(x = subject, y = dprime, fill = factor(setsize)))+
  geom_col(position = position_dodge())+
  labs(x = 'Subject', y = "d'",  title = "Detection sensitivity", fill = 'setsize')+
  scale_x_continuous(breaks = seq(1,s,1))+
  theme_classic()+
  theme(plot.title = element_text(hjust = 0.5))
dplot5

# figure out a way to label infinity
davgss1<- d5 %>% filter(!is.infinite(dprime), setsize == 1)
davgss15 <- mean(davgss1$dprime)
d5ss1sd<-sd(davgss1$dprime)
davgss2<- d5 %>% filter(!is.infinite(dprime), setsize == 2)
davgss25 <- mean(davgss2$dprime)
d5ss2sd<-sd(davgss2$dprime)
rm(davgss1 ,davgss2)

```
# Effect of set size comparison
### t-test
```{r}
#paired 1 sample t test because we're comparing subjects to themselves
# calculated difference in performance on orientation discrimination bewteen noise distractor contrast conditions
ss1 <- hit5 %>% filter(setsize == 1, discrim == 1)
ss2<- hit5 %>% filter(setsize == 2, discrim == 1)
diffc<- ss1$rate - ss2$rate
ttest3 <- t.test(diffc, mu = 0)
ttest3
``` 

#
## Effect of set size
### Raw performance (exact response cw vs ccw)
#### Performance with CCW vs CW discrim, does contrast help?
#### i.e. response must be exact to get correct
#### get hits
```{r}
# count hits
hit6<- data1 %>% filter(!is.nan(testorient)) %>% group_by(subject,setsize, Hit, .drop = FALSE) %>% summarize(n=n())# when probe on target count hits

hit6<- hit6%>% filter(!is.na(Hit)) # remove non response

# check for missing 0s
if (nrow(hit6) < 4*s) {print(paste0('warning check subject missing row'))}# warning missing data
```
##### fill in missing data - so far manual
```{r}
# fill in missing data
##no subject had no misses
missing <- data.frame(6,1, 0, 0)
names(missing) <- c('subject', 'setsize','Hit', 'n')
hit6<- rbind(hit6, missing) # add back missing data
hit6 <- hit6[order(hit6$subject, hit6$setsize, hit6$Hit),] # reorder
rm(missing)

# calculate rate
totals <- rowsum(hit6$n, rep(1:(2*s), each = 2)) 
trials <- rep(totals, each = 2)
hit6$rate <- hit6$n/trials
rm(trials, totals)

```
#### get FAs
```{r}
# count false alarms
FA6 <- data1 %>% filter(is.nan(testorient)) %>% group_by(subject, setsize, .drop = FALSE) %>% count(Hit) # when probe on target count hits
FA6 <- FA6 %>% filter(!is.na(Hit)) # remove non response

# check for missing 0s
if (nrow(FA6) < 4*s) {print(paste0('warning check subject missing row'))}# warning missing data

```
##### fill in missing data - so far manual
```{r}
## subject 2, 5, 6, 8 had no FAs in some conditions
missing <- data.frame(2,2, 0, 0)
names(missing) <- c('subject', 'setsize','Hit', 'n')
FA6<- rbind(FA6, missing) # add back missing data
missing <- data.frame(5,1, 0, 0)
names(missing) <- c('subject', 'setsize','Hit', 'n')
FA6<- rbind(FA6, missing) # add back missing data
missing <- data.frame(5,2, 0, 0)
names(missing) <- c('subject', 'setsize','Hit', 'n')
FA6<- rbind(FA6, missing) # add back missing data
missing <- data.frame(6,1, 0, 0)
names(missing) <- c('subject', 'setsize','Hit', 'n')
FA6<- rbind(FA6, missing) # add back missing data
missing <- data.frame(8,1, 0, 0)
names(missing) <- c('subject', 'setsize','Hit', 'n')
FA6<- rbind(FA6, missing) # add back missing data
missing <- data.frame(8,2, 0, 0)
names(missing) <- c('subject', 'setsize','Hit', 'n')
FA6<- rbind(FA6, missing) # add back missing data
rm(missing)
FA6 <- FA6[order(FA6$subject, FA6$setsize, FA6$Hit),] # reorder

# calculate rate
totals <- rowsum(FA6$n, rep(1:(2*s), each = 2)) 
trials <- rep(totals, each = 2)
FA6$rate <- FA6$n/trials
rm( trials, totals)
```
#### calculate d'
```{r}
hits <- hit6 %>% filter(Hit == 1) # hits
misses <- hit6 %>% filter(Hit == 0) # misses
FAs<- FA6 %>% filter(Hit == 0) # false alarms
CRs<- FA6 %>% filter(Hit == 1) # correct rejections
d6 <- cbind(hits$subject, hits$setsize, hits$n, misses$n, FAs$n, CRs$n)
d6<-data.frame(d6)
names(d6) <- c('subject', 'setsize','hits','misses', 'false_alarms', 'correct_rejections')
d6$Hrate<- hits$rate
d6$FArate<- FAs$rate

d6$dprime<- qnorm(d6$Hrate) - qnorm(d6$FArate)

rm(hits, misses, FAs, CRs)# cleanup vars
```
#### plot performance (hits)
```{r}

hitplot6 <- hit6 %>% filter(Hit == 1) %>%
  ggplot(aes(x = subject, y = rate, fill = factor(setsize)))+
  geom_col(position = position_dodge())+
  labs(x = 'Subject', y = 'Hit rate',  title = "Performance", fill = 'setsize')+
  scale_x_continuous(breaks = seq(1,s,1))+
  theme_classic()+
  theme(plot.title = element_text(hjust = 0.5))
hitplot6

hitavgss1<- hit6 %>% filter(Hit == 1, setsize == 1)
hitavgss16 <- mean(hitavgss1$rate)
hit6ss1sd<-sd(hitavgss1$rate)
hitavgss2<- hit6 %>% filter(Hit ==1, setsize == 2)
hitavgss26 <- mean(hitavgss2$rate)
hit6ss2sd<-sd(hitavgss2$rate)
rm(hitavgss1, hitavgss2)
```
#### plot performance (FAs)
```{r}

FAplot6 <- FA6 %>% filter(Hit == 0) %>%
  ggplot(aes(x = subject, y = rate, fill = factor(setsize)))+
  geom_col(position = position_dodge())+
  labs(x = 'Subject', y = 'False Alarm rate',  title = "Performance", fill = 'setsize')+
  scale_x_continuous(breaks = seq(1,s,1))+
  theme_classic()+
  theme(plot.title = element_text(hjust = 0.5))
FAplot6
```
#### plot detection sensitivity (d')
```{r}
dplot6 <- d6 %>%
  #filter(subject == c(1, 2, 3, 4, 5, 6, 7, 8))%>% # can exclude subjects with 0 FA
  ggplot(aes(x = subject, y = dprime, fill = factor(setsize)))+
  geom_col(position = position_dodge())+
  labs(x = 'Subject', y = "d'",  title = "Detection sensitivity", fill = 'setsize')+
  scale_x_continuous(breaks = seq(1,s,1))+
  theme_classic()+
  theme(plot.title = element_text(hjust = 0.5))
dplot6

davgss1<- d6 %>% filter(!is.infinite(dprime),setsize == 1)
davgss16 <- mean(davgss1$dprime)
d6ss1sd<-sd(davgss1$dprime)
davgss2<- d6 %>% filter(!is.infinite(dprime),setsize == 2)
davgss26 <- mean(davgss2$dprime)
d6ss2sd<-sd(davgss2$dprime)
rm(davgss1, davgss2)

# figure out a way to label infinity

# clear vars
```
# Effect of set size comparison
### t-test
```{r}
#paired 1 sample t test because we're comparing subjects to themselves
# calculated difference in performance on orientation discrimination bewteen noise distractor contrast conditions
ss1 <- hit6 %>% filter(setsize == 1, Hit == 1)
ss2<- hit6 %>% filter(setsize == 2, Hit == 1)
diffc<- ss1$rate - ss2$rate
ttest4 <- t.test(diffc, mu = 0)
ttest4
# significant put an asterisk on this plot
```
#
# Effect of set size and contrast
### Performance descriminating object there or not 
#### i.e. response 1-4 (lines there) vs. response 5 (noise there)
#### get hits
```{r}
# count hits
hit7<- data1 %>% filter(!is.nan(testorient)) %>% group_by(subject, contrast, setsize, .drop = FALSE) %>% count(discrim) # when probe on target count hits
hit7<- hit7%>% filter(!is.na(discrim)) # remove non response

# check for missing 0s
if (nrow(hit7) < 8*s) {print(paste0('warning check subject missing row'))}# warning missing data

```
##### fill in missing data - so far manual
```{r}
# fill in missing data
## subject 1, 2, 8 had  times when reported nothing there when something there
missing <- data.frame(1, 0.5, 1, 0, 0)
names(missing) <- c('subject', 'contrast','setsize','discrim', 'n')
hit7<- rbind(hit7, missing) # add back missing data
missing <- data.frame(1, 0.5, 2, 0, 0)
names(missing) <- c('subject', 'contrast','setsize','discrim', 'n')
hit7<- rbind(hit7, missing) # add back missing data
missing <- data.frame(1, 0.8, 1, 0, 0)
names(missing) <- c('subject', 'contrast','setsize','discrim', 'n')
hit7<- rbind(hit7, missing) # add back missing data
missing <- data.frame(1, 0.8, 2, 0, 0)
names(missing) <- c('subject', 'contrast','setsize','discrim', 'n')
hit7<- rbind(hit7, missing) # add back missing data
missing <- data.frame(2, 0.5, 1, 0, 0)
names(missing) <- c('subject', 'contrast','setsize','discrim', 'n')
hit7<- rbind(hit7, missing) # add back missing data
missing <- data.frame(2, 0.5, 2, 0, 0)
names(missing) <- c('subject', 'contrast','setsize','discrim', 'n')
hit7<- rbind(hit7, missing) # add back missing data
missing <- data.frame(2, 0.8, 2, 0, 0)
names(missing) <- c('subject', 'contrast','setsize','discrim', 'n')
hit7<- rbind(hit7, missing) # add back missing data
missing <- data.frame(5, 0.5, 1, 0, 0)
names(missing) <- c('subject', 'contrast','setsize','discrim', 'n')
hit7<- rbind(hit7, missing) # add back missing data
missing <- data.frame(5, 0.8, 1, 0, 0)
names(missing) <- c('subject', 'contrast','setsize','discrim', 'n')
hit7<- rbind(hit7, missing) # add back missing data
missing <- data.frame(6, 0.5, 1, 0, 0)
names(missing) <- c('subject', 'contrast','setsize','discrim', 'n')
hit7<- rbind(hit7, missing) # add back missing data
missing <- data.frame(6, 0.8, 1, 0, 0)
names(missing) <- c('subject', 'contrast','setsize','discrim', 'n')
hit7<- rbind(hit7, missing) # add back missing data
missing <- data.frame(7, 0.5, 2, 0, 0)
names(missing) <- c('subject', 'contrast','setsize','discrim', 'n')
hit7<- rbind(hit7, missing) # add back missing data
missing <- data.frame(7, 0.8, 2, 0, 0)
names(missing) <- c('subject', 'contrast','setsize','discrim', 'n')
hit7<- rbind(hit7, missing) # add back missing data
missing <- data.frame(8, 0.5, 1, 0, 0)
names(missing) <- c('subject', 'contrast','setsize','discrim', 'n')
hit7<- rbind(hit7, missing) # add back missing data
missing <- data.frame(8, 0.8, 1, 0, 0)
names(missing) <- c('subject', 'contrast','setsize','discrim', 'n')
hit7<- rbind(hit7, missing) # add back missing data
missing <- data.frame(8, 0.8, 2, 0, 0)
names(missing) <- c('subject', 'contrast','setsize','discrim', 'n')
hit7<- rbind(hit7, missing) # add back missing data
hit7 <- hit7[order(hit7$subject, hit7$contrast, hit7$setsize, hit7$discrim),] # reorder
rm(missing)

# calculate rate
totals <- rowsum(hit7$n, rep(1:(4*s), each = 2)) 
trials <- rep(totals, each = 2)
hit7$rate <- hit7$n/trials
rm(trials, totals)


```
#### get FAs
```{r}
# count false alarms
FA7 <- data1 %>% filter(is.nan(testorient)) %>% group_by(subject, contrast, setsize,.drop = FALSE) %>% count(discrim) # when probe on target count hits
FA7 <- FA7 %>% filter(!is.na(discrim)) # remove non response

# check for missing 0s
if (nrow(FA7) < 8*s) {print(paste0('warning check subject missing row'))}# warning missing data


```
##### fill in missing data - so far manual
```{r}
## subject 5, 8 had no FAs
missing <- data.frame(1, 0.5, 2, 0, 0)
names(missing) <- c('subject', 'contrast','setsize','discrim', 'n')
FA7<- rbind(FA7, missing) # add back missing data
missing <- data.frame(1, 0.8, 1, 0, 0)
names(missing) <- c('subject', 'contrast','setsize','discrim', 'n')
FA7<- rbind(FA7, missing) # add back missing data
missing <- data.frame(2, 0.5, 1, 0, 0)
names(missing) <- c('subject', 'contrast','setsize','discrim', 'n')
FA7<- rbind(FA7, missing) # add back missing data
missing <- data.frame(2, 0.5, 2, 0, 0)
names(missing) <- c('subject', 'contrast','setsize','discrim', 'n')
FA7<- rbind(FA7, missing) # add back missing data
missing <- data.frame(2, 0.8, 2, 0, 0)
names(missing) <- c('subject', 'contrast','setsize','discrim', 'n')
FA7<- rbind(FA7, missing) # add back missing data
missing <- data.frame(5, 0.5, 1, 0, 0)
names(missing) <- c('subject', 'contrast','setsize','discrim', 'n')
FA7<- rbind(FA7, missing) # add back missing data
missing <- data.frame(5, 0.5, 2, 0, 0)
names(missing) <- c('subject', 'contrast','setsize','discrim', 'n')
FA7<- rbind(FA7, missing) # add back missing data
missing <- data.frame(5, 0.8, 1, 0, 0)
names(missing) <- c('subject', 'contrast','setsize','discrim', 'n')
FA7<- rbind(FA7, missing) # add back missing data
missing <- data.frame(5, 0.8, 2, 0, 0)
names(missing) <- c('subject', 'contrast','setsize','discrim', 'n')
FA7<- rbind(FA7, missing) # add back missing data
missing <- data.frame(6, 0.5, 1, 0, 0)
names(missing) <- c('subject', 'contrast','setsize','discrim', 'n')
FA7<- rbind(FA7, missing) # add back missing data
missing <- data.frame(6, 0.8, 1, 0, 0)
names(missing) <- c('subject', 'contrast','setsize','discrim', 'n')
FA7<- rbind(FA7, missing) # add back missing data
missing <- data.frame(6, 0.8, 2, 0, 0)
names(missing) <- c('subject', 'contrast','setsize','discrim', 'n')
FA7<- rbind(FA7, missing) # add back missing data
missing <- data.frame(7, 0.5, 1, 0, 0)
names(missing) <- c('subject', 'contrast','setsize','discrim', 'n')
FA7<- rbind(FA7, missing) # add back missing data
missing <- data.frame(7, 0.8, 2, 0, 0)
names(missing) <- c('subject', 'contrast','setsize','discrim', 'n')
FA7<- rbind(FA7, missing) # add back missing data
missing <- data.frame(8, 0.5, 1, 0, 0)
names(missing) <- c('subject', 'contrast','setsize','discrim', 'n')
FA7<- rbind(FA7, missing) # add back missing data
missing <- data.frame(8, 0.5, 2, 0, 0)
names(missing) <- c('subject', 'contrast','setsize','discrim', 'n')
FA7<- rbind(FA7, missing) # add back missing data
missing <- data.frame(8, 0.8, 1, 0, 0)
names(missing) <- c('subject', 'contrast','setsize','discrim', 'n')
FA7<- rbind(FA7, missing) # add back missing data
missing <- data.frame(8, 0.8, 2, 0, 0)
names(missing) <- c('subject', 'contrast','setsize','discrim', 'n')
FA7<- rbind(FA7, missing) # add back missing data
FA7 <- FA7[order(FA7$subject, FA7$contrast, FA7$setsize, FA7$discrim),] # reorder
rm(missing)

# calculate rate
totals <- rowsum(FA7$n, rep(1:(4*s), each = 2)) 
trials <- rep(totals, each = 2)
FA7$rate <- FA7$n/trials
rm(trials, totals)
```
#### calculate d'
```{r}
hits <- hit7 %>% filter(discrim == 1) # hits
misses <- hit7 %>% filter(discrim == 0) # misses
FAs<- FA7 %>% filter(discrim == 0) # false alarms
CRs<- FA7 %>% filter(discrim == 1) # correct rejections
d7 <- cbind(hits$subject,hits$contrast,hits$setsize, hits$n, misses$n, FAs$n, CRs$n)
d7<-data.frame(d7)
names(d7) <- c('subject','contrast', 'setsize', 'hits','misses', 'false_alarms', 'correct_rejections')
d7$Hrate<- hits$rate
d7$FArate<- FAs$rate

d7$dprime<- qnorm(d7$Hrate) - qnorm(d7$FArate)

rm(hits, misses, FAs, CRs)# cleanup vars
```
#### plot performance (hits)
```{r}
# four combos to calculate avgs
# a= (1,.5), b= (1,.8), c =(2, .5), d = (2, .8)
a<- hit7 %>% filter(discrim ==1, contrast == 0.5, setsize == 1)
a.m<- mean(a$rate)
a.s<-sd(a$rate)
b<- hit7 %>% filter(discrim ==1, contrast == 0.8, setsize == 1)
b.m <- mean(b$rate)
b.s<-sd(b$rate)
c<- hit7 %>% filter(discrim ==1, contrast == 0.5, setsize == 2)
c.m <- mean(c$rate)
c.s<-sd(c$rate)
d<- hit7 %>% filter(discrim ==1, contrast == 0.8, setsize == 2)
d.m <- mean(d$rate)
d.s<-sd(d$rate)

# there's a shorter way to do this
agg_discrim <- data.frame(c(a.m,b.m,c.m,d.m))
names(agg_discrim)<-c('mean')
agg_discrim$sd <- c(a.s,b.s,c.s,d.s)
agg_discrim$contrast <- c(.5,.8,.5,.8)
agg_discrim$setsize<- c(1,1,2,2)
rm(a,b, c,d,a.m,a.s,b.m,b.s,c.m,c.s,d.m,d.s)


## add error bars, change color, change contrast labels, increase font size
#plot aggregate
aggplot1 <- agg_discrim %>% 
  ggplot(aes(x = setsize, y = mean, fill = factor(contrast)))+
  geom_col(position = position_dodge())+
  #geom_errorbar(data =sd)+
  labs(x = 'Set Size', y = '% Correct',  title = "Discrimination Performance", fill = 'Contrast')+
  scale_x_continuous(breaks = c(1,2))+
  #scale_fill_gradient()+
  scale_fill_discrete()+
  theme_classic()+
  theme(plot.title = element_text(hjust = 0.5))
aggplot1


## or violin plot it
# create pairs
hit7paired <- hit7 %>% filter(discrim == 1) 
hit7paired <- hit7paired[order(hit7paired$subject, hit7paired$contrast),] # reorder
hit7paired$paired <- rep(1:(32/2), each = 2)


# try to get lines to work
hit7paired <- hit7paired %>% mutate(newc = case_when(contrast == .5 && setsize == 1 ~.45, contrast == .5 && setsize == 2 ~.55, contrast == .8 && setsize == 1 ~.75, contrast == .8 && setsize == 2 ~.85))

aggplot1_violin <-hit7paired %>% 
  ggplot(aes(x = as.factor(newc), y = (100*rate), fill = factor(setsize)))+
  geom_violin()+
  geom_point(aes(x = as.factor(newc),group = paired),position = position_jitterdodge(jitter.width = .3, dodge.width =.2, seed = 123))+
  #geom_point(position = position_dodge(width = .2, seed = 123))+
  labs(x = 'Contrast', y = 'Discrimination (% correct)', fill = 'Set Size')+
  geom_line(aes(x = as.factor(newc),group = paired), color = 'black', alpha = .7,position = position_jitterdodge(jitter.width = .3, dodge.width =.2, seed = 123))+
  #geom_line(aes( group = paired), color = 'black', alpha = .7,position = position_jitterdodge(jitter.width = .3, dodge.width =.8, seed = 123))+
  scale_x_discrete(breaks = c(.45, .75),labels = c('low', 'high'))+
  scale_fill_manual(values = c('#9ebcda', '#8856a7'))+
  theme_classic()+
  theme(text = element_text(size = 20), legend.position = 'none', axis.text.x =  element_text(hjust = -2), axis.ticks = element_blank())
aggplot1_violin
```
#### plot performance (FAs)
```{r}


# aggregate
# four combos to calculate avgs
# a= (1,.5), b= (1,.8), c =(2, .5), d = (2, .8)
a<- FA7 %>% filter(discrim ==0, contrast == 0.5, setsize == 1)
a.m<- mean(a$rate)
a.s<-sd(a$rate)
b<- FA7 %>% filter(discrim ==0, contrast == 0.8, setsize == 1)
b.m <- mean(b$rate)
b.s<-sd(b$rate)
c<- FA7 %>% filter(discrim ==0, contrast == 0.5, setsize == 2)
c.m <- mean(c$rate)
c.s<-sd(c$rate)
d<- FA7 %>% filter(discrim ==0, contrast == 0.8, setsize == 2)
d.m <- mean(d$rate)
d.s<-sd(d$rate)

# there's a shorter way to do this
agg_FA <- data.frame(c(a.m,b.m,c.m,d.m))
names(agg_FA)<-c('mean')
agg_FA$sd <- c(a.s,b.s,c.s,d.s)
agg_FA$contrast <- c(.5,.8,.5,.8)
agg_FA$setsize<- c(1,1,2,2)
rm(a,b, c,d,a.m,a.s,b.m,b.s,c.m,c.s,d.m,d.s)


## add error bars, change color, change contrast labels, increase font size
#plot aggregate
agg_FAplot1 <- agg_FA %>% 
  ggplot(aes(x = setsize, y = mean, fill = factor(contrast)))+
  geom_col(position = position_dodge())+
  #geom_errorbar(data =sd)+
  labs(x = 'Set Size', y = 'False Alarm rate',  title = "False Alarms", fill = 'Contrast')+
  scale_x_continuous(breaks = c(1,2))+
  #scale_fill_gradient()+
  scale_fill_discrete()+
  theme_classic()+
  theme(plot.title = element_text(hjust = 0.5))
agg_FAplot1

# or violin
## or violin plot it
# create pairs
FA7paired <- FA7 %>% filter(discrim == 0) 
FA7paired <- FA7paired[order(FA7paired$subject, FA7paired$contrast),] # reorder
FA7paired$paired <- rep(1:(32/2), each = 2)


# try to get lines to work
FA7paired <- FA7paired %>% mutate(newc = case_when(contrast == .5 && setsize == 1 ~.45, contrast == .5 && setsize == 2 ~.55, contrast == .8 && setsize == 1 ~.75, contrast == .8 && setsize == 2 ~.85))

aggFAplot1_violin <-FA7paired %>% 
  ggplot(aes(x = as.factor(newc), y = rate, fill = factor(setsize)))+
  geom_violin()+
  geom_point(aes(x = as.factor(newc),group = paired),position = position_jitterdodge(jitter.width = .3, dodge.width =.2, seed = 123))+
  labs(x = 'Contrast', y = 'False Alarm Rate', fill = 'Set Size')+
  geom_line(aes(x = as.factor(newc),group = paired), color = 'black', alpha = .7,position = position_jitterdodge(jitter.width = .3, dodge.width =.2, seed = 123))+
  scale_x_discrete(breaks = c(.45, .75),labels = c('low', 'high'))+
  scale_fill_manual(values = c('#9ebcda', '#8856a7'))+
  theme_classic()+
  theme(text = element_text(size = 20), legend.position = 'none', axis.text.x =  element_text(hjust = -2), axis.ticks = element_blank())
aggFAplot1_violin

```
#### plot detection sensitivity (d')
```{r}


# figure out a way to label infinity
davgl<- d3 %>% filter(!is.infinite(dprime), contrast == 0.5)
davgl3 <- mean(davgl$dprime)
sd(davgl$dprime)
davgh<- d3 %>% filter(!is.infinite(dprime), contrast == 0.8)
davgh3 <- mean(davgh$dprime)
sd(davgh$dprime)
rm(davgl ,davgh)

# aggregate
# four combos to calculate avgs
# a= (1,.5), b= (1,.8), c =(2, .5), d = (2, .8)
a<- d7 %>% filter(!is.infinite(dprime), contrast == 0.5, setsize == 1)
a.m<- mean(a$dprime)
a.s<-sd(a$dprime)
b<- d7 %>% filter(!is.infinite(dprime), contrast == 0.8, setsize == 1)
b.m <- mean(b$dprime)
b.s<-sd(b$dprime)
c<- d7 %>% filter(!is.infinite(dprime), contrast == 0.5, setsize == 2)
c.m <- mean(c$dprime)
c.s<-sd(c$dprime)
d<- d7 %>% filter(!is.infinite(dprime), contrast == 0.8, setsize == 2)
d.m <- mean(d$dprime)
d.s<-sd(d$dprime)

# there's a shorter way to do this
agg_d <- data.frame(c(a.m,b.m,c.m,d.m))
names(agg_d)<-c('m_dprime')
agg_d$sd <- c(a.s,b.s,c.s,d.s)
agg_d$contrast <- c(.5,.8,.5,.8)
agg_d$setsize<- c(1,1,2,2)
rm(a,b, c,d,a.m,a.s,b.m,b.s,c.m,c.s,d.m,d.s)


## add error bars, change color, change contrast labels, increase font size
#plot aggregate
agg_dplot1 <- agg_d %>% 
  ggplot(aes(x = factor(contrast), y = m_dprime, fill = factor(setsize)))+
  geom_bar(stat = 'identity', color = 'black', position = position_dodge())+
  geom_errorbar(aes(ymin = m_dprime-sd , ymax =m_dprime+sd), width = .05, position = position_dodge(.9))+
  labs(x = 'Contrast', y = "Detection Sensitivity (d')", fill = 'Set Size')+
  scale_x_discrete(labels = c('low', 'high'))+
  scale_fill_manual(values = c('#9ebcda', '#8856a7'))+
  theme_classic()+
  theme(text = element_text(size = 20), legend.position = 'none')
agg_dplot1


# or violin
## or violin plot it
# create pairs
d7paired <- d7 %>% filter(!is.infinite(dprime)) 
d7paired <- d7paired[order(d7paired$subject, d7paired$contrast),] # reorder
d7paired$paired <- c(1,2,2,3,3,4,4,5,5,6,7)

# try to get lines to work
d7paired <- d7paired %>% mutate(newc = case_when(contrast == .5 && setsize == 1 ~.45, contrast == .5 && setsize == 2 ~.55, contrast == .8 && setsize == 1 ~.75, contrast == .8 && setsize == 2 ~.85))
d7paired$newc<- c(.75,.45,.55,.75,.85,.45,.55,.75,.85,.55,.75)

d7paired %>% 
ggplot(aes(x = as.factor(newc), y = dprime, fill = factor(setsize)))+
  geom_violin()+
  geom_point(aes(group = paired),position = position_jitterdodge(jitter.width = .8, dodge.width =.2))+
  labs(x = 'Contrast', y = 'False Alarm Rate', fill = 'Set Size')+
  #geom_line(aes(x = as.factor(newc),group = paired), color = 'black', alpha = .7,position = position_jitterdodge(jitter.width = .3, dodge.width =.2, seed = 123))+
  scale_x_discrete(breaks = c(.45, .75),labels = c('low', 'high'))+
  scale_fill_manual(values = c('#9ebcda', '#8856a7'))+
  theme_classic()+
  theme(text = element_text(size = 20), axis.ticks = element_blank(), legend.position = 'none') 


# include inf
d7 <- d7 %>% mutate(newc = case_when(contrast == .5 && setsize == 1 ~.45, contrast == .5 && setsize == 2 ~.55, contrast == .8 && setsize == 1 ~.75, contrast == .8 && setsize == 2 ~.85))
d7$newc <-  rep(c(.45,.55,.75,.85), times = s)
d7$paired <- rep(1:(32/2), each = 2)

d7 %>% 
ggplot(aes(x = as.factor(newc), y = dprime, fill = factor(setsize)))+
  geom_violin()+
  geom_point(aes(group = paired),position = position_jitterdodge(jitter.width = .8, dodge.width =.2))+
  labs(x = 'Contrast', y = 'False Alarm Rate', fill = 'Set Size')+
  #geom_line(aes(x = as.factor(newc),group = paired), color = 'black', alpha = .7,position = position_jitterdodge(jitter.width = .3, dodge.width =.2, seed = 123))+
  scale_x_discrete(breaks = c(.45, .75),labels = c('low', 'high'))+
  scale_fill_manual(values = c('#9ebcda', '#8856a7'))+
  theme_classic()+
  theme(text = element_text(size = 20), axis.ticks = element_blank(), legend.position = 'none') 

```
### Performance orientation discrimination
### Performance descriminating orienation
#### get hits
```{r}
# count hits
hit8<- data1 %>% filter(!is.nan(testorient)) %>% group_by(subject, contrast, setsize, .drop = FALSE) %>% count(Hit) # when probe on target count hits
hit8<- hit8%>% filter(!is.na(Hit)) # remove non response

# check for missing 0s
if (nrow(hit8) < 8*s) {print(paste0('warning check subject missing row'))}# warning missing data

```
##### fill in missing data - so far manual
```{r}
# fill in missing data
## subject 1, 2, 8 had  times when reported nothing there when something there

missing <- data.frame(6, 0.5, 1, 0, 0)
names(missing) <- c('subject', 'contrast','setsize','Hit', 'n')
hit8<- rbind(hit8, missing) # add back missing data
missing <- data.frame(6, 0.8, 1, 0, 0)
names(missing) <- c('subject', 'contrast','setsize','Hit', 'n')
hit8<- rbind(hit8, missing) # add back missing data
hit8 <- hit8[order(hit8$subject, hit8$contrast, hit8$setsize, hit8$Hit),] # reorder
rm(missing)

# calculate rate
totals <- rowsum(hit8$n, rep(1:(4*s), each = 2)) 
trials <- rep(totals, each = 2)
hit8$rate <- hit8$n/trials
rm(trials, totals)


```
#### plot performance (hits)
```{r}
# four combos to calculate avgs
# a= (1,.5), b= (1,.8), c =(2, .5), d = (2, .8)
a<- hit8 %>% filter(Hit ==1, contrast == 0.5, setsize == 1)
a.m<- mean(a$rate)
a.s<-sd(a$rate)
b<- hit8 %>% filter(Hit ==1, contrast == 0.8, setsize == 1)
b.m <- mean(b$rate)
b.s<-sd(b$rate)
c<- hit8 %>% filter(Hit ==1, contrast == 0.5, setsize == 2)
c.m <- mean(c$rate)
c.s<-sd(c$rate)
d<- hit8 %>% filter(Hit ==1, contrast == 0.8, setsize == 2)
d.m <- mean(d$rate)
d.s<-sd(d$rate)

# there's a shorter way to do this
agg_ori <- data.frame(c(a.m,b.m,c.m,d.m))
names(agg_ori)<-c('mean')
agg_ori$sd <- c(a.s,b.s,c.s,d.s)
agg_ori$contrast <- c(.5,.8,.5,.8)
agg_ori$setsize<- c(1,1,2,2)
rm(a,b, c,d,a.m,a.s,b.m,b.s,c.m,c.s,d.m,d.s)


## add error bars, change color, change contrast labels, increase font size
#plot aggregate
aggplot2 <- agg_ori %>% 
  ggplot(aes(x = setsize, y = mean, fill = factor(contrast)))+
  geom_col(position = position_dodge())+
  #geom_errorbar(data =sd)+
  labs(x = 'Set Size', y = '% Correct',  title = "Orientation Discrimination Performance", fill = 'Contrast')+
  scale_x_continuous(breaks = c(1,2))+
  #scale_fill_gradient()+
  scale_fill_brewer()+
  theme_classic()+
  theme(plot.title = element_text(hjust = 0.5))
aggplot2

## or violin plot it
# create pairs
hit8paired <- hit8 %>% filter(Hit == 1) 
hit8paired <- hit8paired[order(hit8paired$subject, hit8paired$contrast),] # reorder
hit8paired$paired <- rep(1:(32/2), each = 2)


# try to get lines to work
hit8paired <- hit8paired %>% mutate(newc = case_when(contrast == .5 && setsize == 1 ~.45, contrast == .5 && setsize == 2 ~.55, contrast == .8 && setsize == 1 ~.75, contrast == .8 && setsize == 2 ~.85))

aggplot2_violin <-hit8paired %>% 
  ggplot(aes(x = as.factor(newc), y = (100*rate), fill = factor(setsize)))+
  geom_violin()+
  geom_point(aes(x = as.factor(newc),group = paired),position = position_jitterdodge(jitter.width = .3, dodge.width =.2, seed = 123))+
  #geom_point(position = position_dodge(width = .2, seed = 123))+
  labs(x = 'Contrast', y = 'Orientation Performance (% correct)', fill = 'Set Size')+
  geom_line(aes(x = as.factor(newc),group = paired), color = 'black', alpha = .7,position = position_jitterdodge(jitter.width = .3, dodge.width =.2, seed = 123))+
  #geom_line(aes( group = paired), color = 'black', alpha = .7,position = position_jitterdodge(jitter.width = .3, dodge.width =.8, seed = 123))+
  scale_x_discrete(breaks = c(.45, .75),labels = c('low', 'high'))+
  scale_fill_manual(values = c('#9ebcda', '#8856a7'))+
  theme_classic()+
  theme(text = element_text(size = 20), legend.position = 'none', axis.text.x =  element_text(hjust = -2), axis.ticks = element_blank())
aggplot2_violin
```
# anova
```{r}
# for orientation discrimination
discperf<-hit7paired
discperf$contrast <- factor(discperf$contrast, levels = c(.5, .8), labels = c('low', 'high'))
discperf$setsize <- factor(discperf$setsize, levels = c(1, 2), labels = c('one', 'two'))

discmodel<-lm(formula = rate ~ setsize * contrast, data = discperf) %>% anova()
discmodel
# for detection sensitivity
oriperf<-hit8paired
oriperf$contrast <- factor(oriperf$contrast, levels = c(.5, .8), labels = c('low', 'high'))
oriperf$setsize <- factor(oriperf$setsize, levels = c(1, 2), labels = c('one', 'two'))

orimodel<-lm(formula = rate ~ setsize * contrast, data = oriperf) %>% anova()
orimodel

```
#
#
## Confidence
```{r}
# look at overall conf
confs<- data1 %>% filter(!is.na(conf))%>%group_by(subject) %>% summarise_at(vars(conf), list(name = mean))
confavg <- mean(confs$name)
sd(confs$name)
# look at conf during hits
confsH<- data1 %>% filter(resp == correctresp, !is.na(conf))%>%group_by(subject) %>% summarise_at(vars(conf), list(name = mean))
confavgH <- mean(confsH$name)
sd(confsH$name)
# look at conf during FAs
confsFA<- data1 %>% filter(!is.na(conf), is.na(testorient)) %>% filter(resp != correctresp) %>%group_by(subject) %>% summarise_at(vars(conf), list(name = mean))
confavgFA <- mean(confsFA$name)
sd(confsFA$name)
# look at conf during misses
confsMiss<- data1 %>% filter(resp != correctresp, !is.na(conf))%>%group_by(subject) %>% summarise_at(vars(conf), list(name = mean))
confavgM <- mean(confsMiss$name)
sd(confsMiss$name)
```
## Reaction Time
```{r}
# looking at RT
RTresp <- data1 %>% group_by(subject) %>% summarise_at(vars(respRT), list(name = mean)) # mean RT for each subject
RTrespavg <- mean(RTresp$name)
RTconf <- data1 %>% group_by(subject) %>% summarise_at(vars(confRT), list(name = mean)) # mean RT for each subject
RTconfavg <- mean(RTconf$name)
# they are all faster with confidence interval

# now look at RTs during hits
RTrespH <- data1 %>% filter(resp == correctresp) %>% group_by(subject) %>% summarise_at(vars(respRT), list(name = mean)) # mean RT for each subject
RTrespavgH <- mean(RTrespH$name)
RTconfH <- data1 %>% filter(resp == correctresp) %>% group_by(subject) %>% summarise_at(vars(confRT), list(name = mean)) # mean RT for each subject
RTconfavgH <- mean(RTconfH$name)
# look at RTs during FAs
RTrespFA<- data1 %>% filter(is.na(testorient)) %>% filter(resp != correctresp) %>%group_by(subject) %>% summarise_at(vars(respRT), list(name = mean))
RTrespavgFA <- mean(RTrespFA$name)
RTconfFA<- data1 %>% filter(is.na(testorient)) %>% filter(resp != correctresp) %>%group_by(subject) %>% summarise_at(vars(confRT), list(name = mean))
RTconfavgFA <- mean(RTconfFA$name)
# now look at RTs during misses
RTrespMiss <- data1 %>%  filter(resp != correctresp) %>% group_by(subject) %>% summarise_at(vars(respRT), list(name = mean)) # mean RT for each subject
RTrespavgM <- mean(RTrespMiss$name)
RTconfMiss <- data1 %>% filter(resp != correctresp) %>% group_by(subject) %>% summarise_at(vars(confRT), list(name = mean)) # mean RT for each subject
RTconfavgM <- mean(RTconfMiss$name)
# doesn't look like there's a difference between H and FA RTs but don't have power (n) to test this
```

# look at vertical vs horizontal performance later

# compare both experiments
```{r}
pilot1<- pilot1hit1$rate[pilot1hit1$discrim == 1]
pilot2<- hit1$rate[hit1$discrim == 1]

var.test(pilot1, pilot2) # passes test of homoscedasticity with fisher's F test
comp1<- t.test(pilot1, pilot2, var.equal = TRUE)
comp1 # comparing discrimination accuracy

pilot1<- pilot1hit2$rate[pilot1hit2$Hit == 1]
pilot2<- hit2$rate[hit2$Hit == 1]

var.test(pilot1, pilot2) # passes test of homoscedasticity with fisher's F test
comp2<- t.test(pilot1, pilot2, var.equal = TRUE)
comp2 # comparing discrimination accuracy


pilot1<- pilot1FA1$rate[pilot1FA1$discrim == 0]
pilot2<- FA1$rate[FA1$discrim == 0]

var.test(pilot1, pilot2) # passes test of homoscedasticity with fisher's F test
comp3<- t.test(pilot1, pilot2, var.equal = TRUE)
comp3 # comparing discrimination accuracy


```