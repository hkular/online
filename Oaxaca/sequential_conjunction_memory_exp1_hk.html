<!DOCTYPE html>
<html>

<head>
    <title>Oaxaca</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
    <script src="https://bradylab.ucsd.edu/turk/experiments/Janna/jspsych/dist/jspsych.js"></script>
    <script
        src="https://bradylab.ucsd.edu/turk/experiments/Janna/jspsych/dist/plugin-instructions.js"></script>
    <script
        src="https://bradylab.ucsd.edu/turk/experiments/Janna/jspsych/dist/plugin-html-button-response.js"></script>
    <script src="https://bradylab.ucsd.edu/turk/experiments/Janna/jspsych/dist/plugin-survey-text.js"></script>
    <script
        src="https://bradylab.ucsd.edu/turk/experiments/Janna/jspsych/dist/homemade/plugin-sequential-conjunction-retrocue-v1.js"></script>
    <link rel="stylesheet" href="https://bradylab.ucsd.edu/turk/experiments/Janna/jspsych/dist/jspsych.css">
</head>

<body>
    <script>
        /* Require a new-ish browser: 
    ------------------------------------------ */
        function supportsLiterals() {
            try { return eval("''===``") }
            catch (e) { return false; }
        }
        if (!supportsLiterals()) {
            var txt = "Sorry, this experiment requires a newer browser, so yours is not able to be used. The latest Chrome, Firefox, Safari or Edge all work.";
            alert(txt);
            document.body.onload = function () { document.body.innerHTML = txt; };
        }

        var jsPsych = initJsPsych({
            show_progress_bar: true,
            auto_update_progress_bar: false
        });

        // capture info from Prolific
        
        var subject_id = jsPsych.data.getURLVariable('PROLIFIC_PID');
        var study_id = jsPsych.data.getURLVariable('STUDY_ID');
        var session_id = jsPsych.data.getURLVariable('SESSION_ID');

        jsPsych.data.addProperties({
            subject_id: subject_id,
            study_id: study_id,
            session_id: session_id
        });

        var oaxaca_timeline = []; // instantiate timeline

        /* Instructions 
        ------------------------------------------ */
        var trialList = [];
        var num_ori_practice_trials = 4;
        var num_color_practice_trials = 4;
        var num_both_practice_trials = 8;
        var num_combined_practice_trials = 8;
        var num_trials = 320;

        oaxaca_timeline.push({
            type: jsPsychInstructions,
            pages: ['<p>Welcome to the experiment!</p>',
                '<p>In this experiment, you will have to remember some briefly presented stimuli. You will need to do '+ num_trials +' trials, each of which takes about 3-5 seconds. It should take less than 60 minutes total. <strong>Please do not participate if you do not have normal or corrected-to-normal color vision.</strong> It is OK if you do both this study and other similar Prolific studies that require color, orientation, or shape memory. <p align="center"><img src="instruction_screenshots_v1/click_to_start.png" width="400" border=0></p> When you click to start the trial, you will see one colorful, angled bar followed by another (so two bars total). The stimuli will be presented only very briefly &mdash; shown for under one second &mdash; so be sure not to click to start the trial until you are ready. <strong>Your job is to remember the color and/or the orientation of each object in each location as best you can.</strong> </p><p align="center"><img src="instruction_screenshots_v1/example_stim_2.png" width="400" border=0></p> <p>We are interested in your <b>VISUAL</b> memory. So it is important that you do not say descriptive words to yourself (e.g., "blue" or "vertical line") or use words to perform the task. If you find yourself struggling not to do this, we suggest you repeat the word "the" over and over in your head when the items are presented. This will help you to remember not to use words to remember the colors and angles.</p>',

                '<p> Following the presentation of the colorful bars, there will be a "cue" period, during which you will be told what you need to remember. Everything that is NOT cued you can drop from your memory. The cues consist of one or two letter-number pairs. The letter (a C or an O) indicates color or orientation (C for color, O for orientation). The number (1 or 2) indicates the first or second item. As an example, if you see <strong>C1, C2</strong>, this means that you should remember the color of the first and second item. If you see <strong>C2, O1</strong>, this means you should remember the <strong>COLOR</strong> of the second item and the <strong>ORIENTATION</strong> of the first item. You might only need to remember one feature one item, like in the example below, where you are cued to remember the color of the second item.</p><p align="center"><img src="instruction_screenshots_v1/cue_C2.png" width="400" border=0></p> <p> We ask that you please do your best to use the information given by the cues throughout the task (rather than just remembering the color and orientation of both items).</p> <p>After the cues disappear, you will be almost immediately tested on your memory. Regardless of how many items were cued, you will only be asked to make ONE report. If you are asked to report the <strong>ORIENTATION</strong> of an object, there will be a black wheel, and on the screen will say which item to report. Click the location on the wheel that best matches the angle of the item (you may click either side of the wheel). In the example below, the screen says "Report O2," so you would click the location on the wheel that best matches the angle of the <strong>SECOND</strong> bar. For example, if the line was straight up and down, you would click the top or bottom of the wheel. If you are asked to report the <strong>COLOR</strong> of an object, a rainbow color wheel will appear, and the screen will also say which item to report. Click the location on the wheel that best matches the color of the bar you need to report. In this example, the screen says "Report C2," so you would click the location on the wheel that best matches the color of the second item</p> <p align="center"><img src="instruction_screenshots_v1/report_O2.png" width="400" border=0><img src="instruction_screenshots_v1/report_C2.png" width="400" border=0></p>',

                '<p>To start off with, we will give you '+(num_ori_practice_trials+num_color_practice_trials+num_both_practice_trials+num_combined_practice_trials)+'practice trials &mdash; '+num_ori_practice_trials+' trials reporting color, '+num_color_practice_trials+' trials reporting orientation, '+num_both_practice_trials+' trials where either the color or the orientation could be probed, and then '+num_combined_practice_trials+' more with all conditions combined. Then you will need to do '+ num_trials +' trials of the main task.</p><p>As a disclaimer, we are interested in memory errors, and this task is designed to be quite challenging so that you will not remember the items perfectly. Please do not worry if your performance seems low.</p><p text-align="left">Before beginning, you must give informed consent. Please read the following and indicate your agreement by continuing to the next page to start the practice trials:</p> <div id="consentDiv"><p><u>Consent to Act as a Research Subject:</u></p><p style="text-align:left">Dr. John Serences is conducting a research study to learn more about how attention affects how you see things (perception) and how you make simple decisions. There will be approximately 5,000 participants in the study over the next 10 years.</p><p style="text-align:left">PROCEDURES. If you agree to be in this study by clicking NEXT and continuing to this task, the following will happen to you: You will be presented with stimuli that consist of simple objects presented on a computer screen. You will respond with button presses and/or using your computer mouse.</p> <p style="text-align:left">RISKS. You will be required only to continue to interact with your web browser and make responses for a short duration. Thus, no potential risks or discomforts are anticipated except for the possibility that some tasks may be slightly boring. However, there may be risks that are currently unforeseeable.</p> <p style="text-align:left">REMUNERATION. In consideration of your time and effort you will receive SONA credit for your participation (0.5 credits for 30 minutes).</p><p style="text-align:left">RIGHTS.  If you are injured as a direct result of participation in this research, the University of California will provide any medical care you need to treat those injuries. The University will not provide any other form of compensation to you if you are injured. You may call the Human Research Protections Program at 858-246- 4777 for more information about this, to inquire about your rights as a research subject, or to report research- related problems.</p><p style="text-align:left">BENEFITS.  There will not be any direct benefit to you from these procedures. The investigator, however, may learn more about how human beings pay attention and how this ability affects perception and decision making. </p><p style="text-align:left">EXPLANATION.  Dr. John Serences or a member of his research team has explained this study to you and answered your questions. If you have other questions or research-related problems, you may reach him at 858- 534-3686.</p><p style="text-align:left">VOLUNTARY NATURE OF PARTICIPATION.  Participation in this research is entirely voluntary. There is no cost to you for participating. The alternative to participating is not participating. You may refuse to participate or you may withdraw at any time without jeopardy to the medical care you will receive at this institution, without loss of any access to the care to which you are entitled, or loss of the benefits to which you are entitled. You may also be withdrawn from the study if the investigator feels it is in your best interest or for other study-related purposes. If you wish to withdraw from the study tell a member of the study staff and the testing session will terminate immediately. You will be compensated for the time you have spent.</p><p style="text-align:left">CONFIDENTIALITY.  Research records will be kept confidential to the extent provided by law. Research records will only be accessible by Dr Serences and his research team, and by the UCSD Institutional Review Board. You have received a copy of this consent document. </p><p style="text-align:left">By clicking NEXT, you are indicating that you are at least 18 years old, have read this consent form and agree to participate in this research study. Please print a copy of this page for your records.</p></div>'],
            show_clickable_nav: true

        })
        
        oaxaca_timeline.push({
            type: jsPsychInstructions,
            pages: ['First, we will do some orientation practice trials. Click NEXT to proceed.'],
            show_clickable_nav: true
        })

        var ori_trials = {
            timeline: [
                {
                    type: jsPsychSequentialConjunctionRetrocue,
                    data: {is_practice: true},
                    wheel_spin: false,
                    set_size: 2,
                    memory_set_size: jsPsych.timelineVariable('memory_set_size'),
                    feature_cue: jsPsych.timelineVariable('feature_cue'),
                    feature_recall: jsPsych.timelineVariable('feature_recall'),
                    feature_separate_objects: jsPsych.timelineVariable('feature_separate_objects'),
                    probe_position: jsPsych.timelineVariable('probe_position'),
                    num_placeholders: 2,
                    feedback: true
                }
            ],
            timeline_variables: [
                {memory_set_size: 1, feature_cue: 1, feature_separate_objects: false, feature_recall: 1, probe_position: 1},
                {memory_set_size: 1, feature_cue: 1, feature_separate_objects: false, feature_recall: 1, probe_position: 2},
                {memory_set_size: 2, feature_cue: 1, feature_separate_objects: false, feature_recall: 1, probe_position: 1},
                {memory_set_size: 2, feature_cue: 1, feature_separate_objects: false, feature_recall: 1, probe_position: 2}
            ],
            randomize_order: true,
            repetitions: 1,
        }

        oaxaca_timeline.push(ori_trials);

        oaxaca_timeline.push({
            type: jsPsychInstructions,
            pages: ['Next, we will do some color practice trials. Click NEXT to proceed.'],
            show_clickable_nav: true
        })

        var color_trials = {
            timeline: [
                {
                    type: jsPsychSequentialConjunctionRetrocue,
                    data: {is_practice: true},
                    wheel_spin: false,
                    set_size: 2,
                    memory_set_size: jsPsych.timelineVariable('memory_set_size'),
                    feature_cue: jsPsych.timelineVariable('feature_cue'),
                    feature_recall: jsPsych.timelineVariable('feature_recall'),
                    feature_separate_objects: jsPsych.timelineVariable('feature_separate_objects'),
                    probe_position: jsPsych.timelineVariable('probe_position'),
                    num_placeholders: 2,
                    feedback: true
                }
            ],
            timeline_variables: [
                {memory_set_size: 1, feature_cue: 2, feature_separate_objects: false, feature_recall: 2, probe_position: 1},
                {memory_set_size: 1, feature_cue: 2, feature_separate_objects: false, feature_recall: 2, probe_position: 2},
                {memory_set_size: 2, feature_cue: 2, feature_separate_objects: false, feature_recall: 2, probe_position: 1},
                {memory_set_size: 2, feature_cue: 2, feature_separate_objects: false, feature_recall: 2, probe_position: 2}
            ],
            randomize_order: true,
            repetitions: 1,
        }

        oaxaca_timeline.push(color_trials);

        oaxaca_timeline.push({
            type: jsPsychInstructions,
            pages: ['Next, we will do some practice trials where both orientation and color are cued. Click NEXT to proceed.'],
            show_clickable_nav: true
        })

        var both_trials = {
            timeline: [
                {
                    type: jsPsychSequentialConjunctionRetrocue,
                    data: {is_practice: true},
                    wheel_spin: false,
                    set_size: 2,
                    memory_set_size: jsPsych.timelineVariable('memory_set_size'),
                    feature_cue: jsPsych.timelineVariable('feature_cue'),
                    feature_recall: jsPsych.timelineVariable('feature_recall'),
                    feature_separate_objects: jsPsych.timelineVariable('feature_separate_objects'),
                    probe_position: jsPsych.timelineVariable('probe_position'),
                    num_placeholders: 2,
                    feedback: true
                }
            ],
            timeline_variables: [
                {memory_set_size: 1, feature_cue: 3, feature_separate_objects: false, feature_recall: 1, probe_position: 1},
                {memory_set_size: 1, feature_cue: 3, feature_separate_objects: false, feature_recall: 1, probe_position: 2},
                {memory_set_size: 1, feature_cue: 3, feature_separate_objects: false, feature_recall: 2, probe_position: 1},
                {memory_set_size: 1, feature_cue: 3, feature_separate_objects: false, feature_recall: 2, probe_position: 2},
                {memory_set_size: 2, feature_cue: 3, feature_separate_objects: true, feature_recall: 1, probe_position: 1}, 
                {memory_set_size: 2, feature_cue: 3, feature_separate_objects: true, feature_recall: 1, probe_position: 2}, 
                {memory_set_size: 2, feature_cue: 3, feature_separate_objects: true, feature_recall: 2, probe_position: 1}, 
                {memory_set_size: 2, feature_cue: 3, feature_separate_objects: true, feature_recall: 2, probe_position: 2}, 
            ],
            randomize_order: true,
            repetitions: 1,
        }

        oaxaca_timeline.push(both_trials);

        oaxaca_timeline.push({
            type: jsPsychInstructions,
            pages: ['Almost there! Finally, we will do practice trials where color, orientation, or both could be probed. And, remember: this task is supposed to be hard! So do not be discouraged.'],
            show_clickable_nav: true
        })

        var practice_trials = {
            timeline: [
                {
                    type: jsPsychSequentialConjunctionRetrocue,
                    data: {is_practice: true},
                    wheel_spin: false,
                    set_size: 2,
                    memory_set_size: jsPsych.timelineVariable('memory_set_size'),
                    feature_cue: jsPsych.timelineVariable('feature_cue'),
                    feature_recall: jsPsych.timelineVariable('feature_recall'),
                    feature_separate_objects: jsPsych.timelineVariable('feature_separate_objects'),
                    probe_position: jsPsych.timelineVariable('probe_position'),
                    num_placeholders: 2,
                    feedback: true
                }
            ],
            timeline_variables: [
                {memory_set_size: 1, feature_cue: 1, feature_separate_objects: false, feature_recall: 1, probe_position: 1},
                {memory_set_size: 2, feature_cue: 1, feature_separate_objects: false, feature_recall: 1, probe_position: 2},
                {memory_set_size: 1, feature_cue: 2, feature_separate_objects: false, feature_recall: 2, probe_position: 2},
                {memory_set_size: 2, feature_cue: 2, feature_separate_objects: false, feature_recall: 2, probe_position: 1},
                {memory_set_size: 1, feature_cue: 3, feature_separate_objects: false, feature_recall: 1, probe_position: 1},
                {memory_set_size: 1, feature_cue: 3, feature_separate_objects: false, feature_recall: 2, probe_position: 2},
                {memory_set_size: 2, feature_cue: 3, feature_separate_objects: true, feature_recall: 1, probe_position: 1}, 
                {memory_set_size: 2, feature_cue: 3, feature_separate_objects: true, feature_recall: 2, probe_position: 2}, 
            ],
            randomize_order: true,
            repetitions: 1,
        }

        oaxaca_timeline.push(practice_trials);

        oaxaca_timeline.push({
            type: jsPsychInstructions,
            pages: ['Phew! You are now ready to begin the main task. As a note, you will no longer receive feedback after each trial. Click NEXT to proceed.'],
            show_clickable_nav: true
        })
        

        var trialCount = 0;
        function updateCounter() {
            trialCount = trialCount + 1;
            jsPsych.setProgressBar(trialCount / num_trials);
        }

        var trials = {
            timeline: [
                {
                    type: jsPsychSequentialConjunctionRetrocue,
                    data: {is_practice: false},
                    wheel_spin: false,
                    set_size: 2,
                    memory_set_size: jsPsych.timelineVariable('memory_set_size'),
                    feature_cue: jsPsych.timelineVariable('feature_cue'),
                    feature_recall: jsPsych.timelineVariable('feature_recall'),
                    feature_separate_objects: jsPsych.timelineVariable('feature_separate_objects'),
                    probe_position: jsPsych.timelineVariable('probe_position'),
                    num_placeholders: 2,
                    feedback: false,
                    on_finish: updateCounter
                }
            ],
            timeline_variables: [
                {memory_set_size: 1, feature_cue: 1, feature_separate_objects: false, feature_recall: 1, probe_position: 1},
                {memory_set_size: 1, feature_cue: 1, feature_separate_objects: false, feature_recall: 1, probe_position: 2},
                {memory_set_size: 2, feature_cue: 1, feature_separate_objects: false, feature_recall: 1, probe_position: 1},
                {memory_set_size: 2, feature_cue: 1, feature_separate_objects: false, feature_recall: 1, probe_position: 2},
                {memory_set_size: 1, feature_cue: 2, feature_separate_objects: false, feature_recall: 2, probe_position: 1},
                {memory_set_size: 1, feature_cue: 2, feature_separate_objects: false, feature_recall: 2, probe_position: 2},
                {memory_set_size: 2, feature_cue: 2, feature_separate_objects: false, feature_recall: 2, probe_position: 1},
                {memory_set_size: 2, feature_cue: 2, feature_separate_objects: false, feature_recall: 2, probe_position: 2},
                {memory_set_size: 1, feature_cue: 3, feature_separate_objects: false, feature_recall: 1, probe_position: 1},
                {memory_set_size: 1, feature_cue: 3, feature_separate_objects: false, feature_recall: 1, probe_position: 2},
                {memory_set_size: 1, feature_cue: 3, feature_separate_objects: false, feature_recall: 2, probe_position: 1},
                {memory_set_size: 1, feature_cue: 3, feature_separate_objects: false, feature_recall: 2, probe_position: 2},
                {memory_set_size: 2, feature_cue: 3, feature_separate_objects: true, feature_recall: 1, probe_position: 1}, 
                {memory_set_size: 2, feature_cue: 3, feature_separate_objects: true, feature_recall: 1, probe_position: 2}, 
                {memory_set_size: 2, feature_cue: 3, feature_separate_objects: true, feature_recall: 2, probe_position: 1}, 
                {memory_set_size: 2, feature_cue: 3, feature_separate_objects: true, feature_recall: 2, probe_position: 2}, 
            ],
            randomize_order: true,
            repetitions: num_trials/16,
        }

        oaxaca_timeline.push(trials);
        
        
        oaxaca_timeline.push({
            type: jsPsychSurveyText,
            preamble: "Thank you! You're just about done. If you would, please tell us about yourself:",
            questions: [
                { prompt: "How old are you?", name: 'age', rows: 1, columns: 5 },
                { prompt: "Gender:", name: 'gender', rows: 1, columns: 40 },
                { prompt: "Any comments? Was it fun? Any technical difficulties?:", name: 'comments', rows: 3, columns: 40 }
            ],
            button_label: "Submit",
            on_finish: function() {SendToServer()}
        });

        
        oaxaca_timeline.push({
            type: jsPsychInstructions,
            pages: ['<p>Thank you! You are all done. Press "Next" to be taken back to Prolific.</p>'],
            show_clickable_nav: true,
            on_finish: function () {
                window.location.assign("https://app.prolific.co/submissions/complete?cc=CZK8O427");
            },
        });

        jsPsych.run(oaxaca_timeline);
        

        // Send the data to the server as JSON: 
        
        var SendToServer = () => {
            console.log('saving data');
            expt_data = {
                "curTime": jsPsych.getStartTime(),
                "sub_id": subject_id,
                "userAgent": navigator.userAgent,
                "windowWidth": window.innerWidth,
                "windowHeight": window.innerHeight,
                "screenWidth": screen.width,
                "screenHeight": screen.height,
                "totalTime": jsPsych.getTotalTime(),
                "interactionData": jsPsych.data.getInteractionData().json(),
                "fullData": jsPsych.data.get().json(),
                "surveyData": jsPsych.data.get().select('response'),

                "is_practice": jsPsych.data.get().select('is_practice'),
                "position_of_items": jsPsych.data.get().select('position_of_items'),
                "probe_position": jsPsych.data.get().select('probe_position'),
                "item_angles": jsPsych.data.get().select('item_angles'),
                "item_colors": jsPsych.data.get().select('item_colors'),
                "probe_angle": jsPsych.data.get().select('probe_angle'),
                "reported_angle": jsPsych.data.get().select('reported_angle'),
                "reported_angle_wrapped": jsPsych.data.get().select('reported_angle_wrapped'),
                "trial_error": jsPsych.data.get().select('trial_error'),
                "memory_set_size": jsPsych.data.get().select('memory_set_size'),
                "feature_cue": jsPsych.data.get().select('feature_cue'),
                "feature_recall": jsPsych.data.get().select('feature_recall'),
                "feature_separate_objects": jsPsych.data.get().select('feature_separate_objects'),
                "display_time": jsPsych.data.get().select('display_time'),
                "actual_stim1_duration": jsPsych.data.get().select('actual_stim1_duration'),
                "actual_stim2_duration": jsPsych.data.get().select('actual_stim2_duration'),
                "interstimulus_interval": jsPsych.data.get().select('interstimulus_interval'),
                "pre_retrocue_time": jsPsych.data.get().select('pre_retrocue_time'),
                "retrocue_time": jsPsych.data.get().select('retrocue_time'),
                "post_retrocue_time": jsPsych.data.get().select('post_retrocue_time'),
            };
            var dataToServer = {
                'id': subject_id,
                'experimenter': 'Janna',
                'experimentName': 'oaxaca_v1',
                'curData': JSON.stringify(expt_data)
            };
            $.post("https://bradylab.ucsd.edu/turk/save.php", dataToServer)
        }
        

    </script>

</html>